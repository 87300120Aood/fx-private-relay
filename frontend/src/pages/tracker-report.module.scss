@use "../styles/tokens";
@use "~@mozilla-protocol/core/protocol/css/includes/lib";
@use "../styles/typography";

.wrapper {
  height: 100%;
  display: flex;
  flex-direction: column;
  // <html> and <body> have overflow set to hidden to accommodate header
  // positioning (for more info, see `.non-header-wrapper` in
  // Layout.module.scss), so overflow: auto is needed to re-enable the scrollbar:
  overflow: auto;
}

@keyframes fadein {
  from {
    opacity: 0;
  }
  50% {
    // Let the loading screen stay hidden for 200ms;
    // if it gets removed in that time (because the report has initialised),
    // showing a "loading" message is just distracting:
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.loading {
  padding: lib.$spacing-xl;
  height: 100%;
  background-color: tokens.$color-grey-05;
  animation-name: fadein;
  animation-duration: 400ms;
}

.load-error {
  padding: lib.$spacing-xl;
  height: 100%;
  background-color: tokens.$color-grey-05;
}

.report-wrapper {
  background-color: tokens.$color-grey-05;
  flex: 1 0 auto;
  display: flex;
  justify-content: center;

  .report {
    width: 100%;
    max-width: lib.$content-xl;
    padding: lib.$spacing-xl;
    display: flex;
    flex-direction: column;
    gap: lib.$spacing-md;
  }

  .logo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: lib.$spacing-xs;

    .logomark {
      max-height: 35px;
    }
    .logotype {
      max-height: 20px;
    }
  }

  h1 {
    @include typography.text-title-2xs {
      font-family: lib.$font-stack-firefox;
      padding: lib.$spacing-md 0;
      border-bottom: 1px solid tokens.$color-grey-20;
    }
  }

  .meta {
    display: flex;
    flex-direction: column;
    gap: lib.$spacing-md;
    padding: lib.$spacing-lg;

    @media screen and #{lib.$mq-md} {
      flex-direction: row;
      gap: lib.$spacing-2xl;
      padding: lib.$spacing-lg lib.$spacing-2xl;
    }

    dt {
      color: tokens.$color-grey-40;
    }

    dd {
      font-weight: 600;
      color: tokens.$color-grey-50;
    }

    .from {
      flex: 1 0 auto;

      dd {
        text-overflow: ellipsis;
        overflow: hidden;
        max-width: lib.$content-sm;
      }
    }
  }

  .trackers {
    background-color: lib.$color-white;
    border-radius: lib.$border-radius-md;
    display: flex;
    flex-direction: column;
    box-shadow: lib.$box-shadow-sm;
    // We typically avoid margins because they affect the positioning of other elements,
    // but since box-shadow is visible below the element, the bottom margin lets
    // us pretend like it's part of the element:
    margin-bottom: lib.$spacing-md;
    padding: lib.$spacing-lg;
    gap: lib.$spacing-md;

    @media screen and #{lib.$mq-md} {
      padding: lib.$spacing-lg lib.$spacing-2xl;
      gap: lib.$spacing-xl;
    }

    h2 {
      @include typography.text-title-xs {
        font-family: lib.$font-stack-firefox;
        font-weight: 500;
      }
    }

    table {
      // The table heading only exists for screen readers.
      // See https://webaim.org/techniques/css/invisiblecontent/#offscreen.
      thead {
        position: absolute;
        width: 1px;
        height: 1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        clip-path: circle(0);
      }

      tr {
        display: grid;
        grid-template-areas:
          "icon tracker-domain"
          "null count";
        grid-template-columns: auto 1fr auto;
        align-items: center;
        column-gap: lib.$spacing-md;
        row-gap: lib.$spacing-xs;
        padding: lib.$spacing-md 0;
        color: tokens.$color-grey-50;
        border-top: 1px solid tokens.$color-grey-10;

        .icon {
          grid-area: icon;
          color: tokens.$color-grey-20;
        }

        .tracker-domain {
          grid-area: tracker-domain;
          flex: 1 0 auto;
          font-weight: 600;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .count {
          grid-area: count;
          width: 100%;
        }

        @media screen and #{lib.$mq-sm} {
          grid-template-areas: "icon tracker-domain count";

          .count {
            width: auto;
          }
        }
      }
    }
  }

  .confidentiality-notice {
    display: flex;
    align-items: center;
    gap: lib.$spacing-md;
    background-color: tokens.$color-grey-10;
    padding: lib.$spacing-lg;
    border-radius: lib.$border-radius-md;

    @media screen and #{lib.$mq-md} {
      padding: lib.$spacing-lg lib.$spacing-2xl;
    }

    svg {
      color: lib.$color-purple-70;
      flex: 1 0 auto;
    }
  }

  .explainer {
    display: flex;
    flex-direction: column;
    gap: lib.$spacing-md;
    padding: lib.$spacing-lg;

    @media screen and #{lib.$mq-md} {
      padding: lib.$spacing-lg lib.$spacing-2xl;
    }

    hr {
      background-color: tokens.$color-grey-10;
      height: 2px;
      border-style: none;
    }

    .breakage-warning {
      display: flex;
      align-items: center;
      gap: lib.$spacing-md;
      border-radius: lib.$border-radius-sm;
      border: 2px solid lib.$color-yellow-50;
      padding: lib.$spacing-lg;

      svg {
        color: lib.$color-yellow-50;
        flex: 1 0 auto;
      }
    }
  }
}

.faq-wrapper {
  background-color: lib.$color-white;
}

.faq {
  width: lib.$content-max;
  max-width: 100%;
  margin: 0 auto;
  padding: lib.$spacing-lg;
  display: flex;
  flex-direction: column;

  .lead {
    flex: 1 0 0;

    @media screen and #{lib.$mq-md} {
      padding: 0 lib.$spacing-2xl;
    }

    .headline {
      @include typography.text-title-sm {
        font-family: lib.$font-stack-firefox;
        font-weight: 500;
        padding: lib.$spacing-md 0;
      }
    }

    .read-more {
      color: lib.$color-blue-50;
      font-weight: 500;
      text-decoration: underline;

      &:hover {
        text-decoration: none;
      }
    }
  }

  .entries {
    flex: 1 0 0;
    padding-top: lib.$spacing-lg;

    @media screen and #{lib.$mq-md} {
      padding: 0 lib.$spacing-2xl;
    }
  }

  @media screen and #{lib.$mq-md} {
    flex-direction: row;
    gap: lib.$spacing-md;
  }
}
